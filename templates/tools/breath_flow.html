{% extends "base.html" %}

{% block hero %}
<section class="calm-hero hero-grid flow-hero">
    <div class="hero-copy">
        <p class="eyebrow">Calming practice</p>
        <h1>Calming Breath Flow</h1>
        <p class="lede">A gentle breathing lane that keeps the visuals tidy and the controls simple. Set a rhythm that feels comfortable, press start, and let the on-screen cues guide you without the clutter.</p>
        <div class="flow-hero__metrics">
            <div class="metric-pill">
                <p class="microcopy muted">Starts logged</p>
                <p class="stat-number" data-calming-view="{{ tool.slug }}">{{ view_count }}</p>
                <p class="stat-helper">Times visitors began this flow</p>
            </div>
            <div class="metric-pill">
                <p class="microcopy muted">Completion taps</p>
                <p class="stat-number" data-calming-count="{{ tool.slug }}">{{ completed_count }}</p>
                <p class="stat-helper">Visitors logging this practice</p>
            </div>
            <div class="metric-pill">
                <p class="microcopy muted">Default rhythm</p>
                <p class="stat-number">4 • 2 • 5 • 2</p>
                <p class="stat-helper">Inhale • hold • exhale • hold</p>
            </div>
        </div>
        <div class="calm-hero__actions">
            <a class="btn" href="#interactive-calm">Start guided flow</a>
            <a class="btn ghost" href="{{ url_for('calming_tools') }}">Back to overview</a>
        </div>
    </div>
    <div class="calm-hero__panel flow-panel">
        <div class="calm-hero__panel-inner">
            <p class="eyebrow">Everything aligned</p>
            <h3>Wave, timing, and cues share one clean grid.</h3>
            <p class="body">Pick the numbers that feel supportive, keep your focus on the centre ring, and let the phase chips reassure you about what comes next.</p>
            <ul class="flow-list">
                <li>Responsive ring that mirrors each inhale and exhale</li>
                <li>Phase chips that light up so you never lose your place</li>
                <li>Session timer, start/pause, and reset controls in one spot</li>
            </ul>
            <div class="calm-hero__panel-actions">
                <a class="btn tiny" href="{{ url_for('calming_tools') }}">Explore calming tools</a>
                <a class="btn ghost tiny" href="https://youtu.be/3cXGt2d1RyQ?si=fW6VP-S2ooxIlJdK" target="_blank" rel="noopener">Watch calming video</a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<section class="calm-lab" id="interactive-calm">
    <div class="calm-lab__header flow-board__header">
        <div>
            <p class="eyebrow">Interactive</p>
            <h2>Set a calming rhythm and let the cues do the work.</h2>
            <p class="lede">Adjust the timing sliders, hit start, and follow the centre ring. The wave, label, and timeline chips stay in sync so you can simply breathe.</p>
        </div>
        <div class="calm-lab__badges flow-badges">
            <span class="chip ghost">Session timer</span>
            <span class="chip ghost">Wave intensity</span>
            <span class="chip ghost">Aligned cues</span>
        </div>
    </div>
    <div class="calm-lab__grid flow-board">
        <div class="control-stack duo flow-controls">
            <div class="control-card slim">
                <div class="control-card__header">
                    <p class="eyebrow muted">Timing</p>
                    <p class="microcopy" data-cycle-preview>4s inhale • 2s hold • 5s exhale • 2s hold</p>
                </div>
                <div class="control-row refined compact">
                    <label class="control">
                        <span>Inhale (seconds)</span>
                        <input type="number" min="1" max="20" value="4" step="0.5" data-inhale-input />
                        <span class="value">Lengthen the in-breath.</span>
                    </label>
                    <label class="control">
                        <span>Hold (seconds)</span>
                        <input type="number" min="0" max="20" value="2" step="0.5" data-hold-input />
                        <span class="value">Linger lightly at the top.</span>
                    </label>
                    <label class="control">
                        <span>Exhale (seconds)</span>
                        <input type="number" min="1" max="20" value="5" step="0.5" data-exhale-input />
                        <span class="value">Let the breath drift out.</span>
                    </label>
                </div>
            </div>
            <div class="control-card slim">
                <div class="control-card__header">
                    <p class="eyebrow muted">Session feel</p>
                    <p class="microcopy">Keep the visuals steady and grounded.</p>
                </div>
                <div class="control-row refined compact">
                    <label class="control">
                        <span>Session length (minutes)</span>
                        <input type="number" min="1" max="30" value="5" step="1" data-session-input />
                        <span class="value" data-session-remaining>5:00 remaining</span>
                    </label>
                    <label class="control">
                        <span>Wave intensity</span>
                        <input type="range" min="0.8" max="1.4" value="1" step="0.1" data-wave-range />
                        <span class="value" data-wave-value>Balanced</span>
                    </label>
                </div>
            </div>
            <div class="calm-lab__actions">
                <button class="btn" type="button" data-calm-start data-calming-slug="{{ tool.slug }}">Start flow</button>
                <button class="btn ghost" type="button" data-calm-reset>Reset</button>
                <p class="body" data-affirmation>Pick timing that feels supportive and press “Start flow.”</p>
            </div>
            <div class="flow-footnote">
                <p class="microcopy">Every slider and number sits on the same rhythm as the ring so your eyes never hunt for the next cue.</p>
            </div>
        </div>
        <div class="immersive-visual elevated flow-visual">
            <span class="flow-visual__halo"></span>
            <span class="flow-visual__halo halo-secondary"></span>
            <div class="flow-visual__header">
                <a class="btn ghost calm-video-link" href="https://youtu.be/H1pBZ9JQWEI?si=kOm7fi_PqO9Rnwd-" target="_blank" rel="noopener">
                    Play calming guidance
                </a>
                <span class="chip ghost">Glowing rhythm</span>
            </div>
            <div class="flow-visual__arena">
                <div class="pulse-ring" data-pulse-ring></div>
                <div class="phase-label" data-phase-label>Ready when you are</div>
                <div class="flow-wave" aria-hidden="true">
                    <div class="flow-wave__rail">
                        <div class="flow-wave__fill" data-wave-fill></div>
                        <div class="flow-wave__dot" data-wave-dot>
                            <span class="flow-wave__dot-glow"></span>
                            <span class="flow-wave__phase" data-wave-phase>Flow ready</span>
                        </div>
                    </div>
                </div>
                <div class="phase-timeline" data-phase-timeline>
                    <span class="chip">Inhale</span>
                    <span class="chip">Hold</span>
                    <span class="chip">Exhale</span>
                    <span class="chip">Hold</span>
                </div>
            </div>
        </div>
    </div>
</section>

<section class="panel">
    <div class="flow-grid">
        <div class="flow-summary">
            <p class="eyebrow">How to use this flow</p>
            <h2>Choose a pace once, then repeat for calm.</h2>
            <p class="body">Stay within a range that feels easy to maintain. The 4–2–5–2 pattern is a gentle default, but you can shorten the holds or lengthen the exhale if that feels steadier.</p>
            <div class="microchips">
                <span class="microchip">Steady 4–2–5–2 base</span>
                <span class="microchip">Adjustable intensity</span>
                <span class="microchip">Session countdown</span>
            </div>
            <div class="flow-steps">
                <ol class="breath tight">
                    <li>Pick your inhale, hold, and exhale lengths in the controls above.</li>
                    <li>Set a session length that matches your energy. Shorter is fine.</li>
                    <li>Press <strong>Start flow</strong>. Pause any time if you need to regain comfort.</li>
                    <li>Log a completion when you finish, or tap reset to begin again.</li>
                </ol>
            </div>
        </div>
        <div class="flow-steps">
            <p class="eyebrow">Safety first</p>
            <p class="body">If you feel dizzy, light-headed, or uncomfortable, stop the flow, return to your natural breath, and resume only when you feel ready. Aim for smooth, silent breaths rather than force.</p>
            <ul class="breath tight">
                <li>Keep shoulders relaxed and jaw unclenched.</li>
                <li>Let the exhale be slightly longer than the inhale for added calm.</li>
                <li>Sit or stand with support so you can soften into the rhythm.</li>
            </ul>
        </div>
    </div>
</section>
{% endblock %}

{% block scripts %}
    <script src="/static/js/breath-flow.js"></script>
{% endblock %}
