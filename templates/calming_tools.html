{% extends "base.html" %}

{% block hero %}
<section class="calm-hero hero-grid">
    <div class="hero-copy">
        <p class="eyebrow">Find your calm</p>
        <h1>A soothing studio for breath, body, and reset.</h1>
        <p class="lede">Choose the tool that fits how you feel right now—each one keeps the original visuals, timing, and cues you know. Start from the overview and dive into the dedicated page for the full experience.</p>
        <div class="calm-hero__actions">
            <a class="btn" href="{{ url_for('calming_tool', slug='breath-flow') }}">Start Breath Flow</a>
            <a class="btn ghost" href="#tools">Browse every tool</a>
        </div>
        <div class="calm-hero__meta">
            <div class="meta-card">
                <p class="microcopy">Breath pacing</p>
                <p class="stat-number">4s inhale • 2s hold • 5s exhale • 2s hold</p>
            </div>
            <div class="meta-card">
                <p class="microcopy">Session timer</p>
                <p class="stat-number">5:00 ready to begin</p>
            </div>
            <div class="meta-card">
                <p class="microcopy">Feeling check</p>
                <p class="body">Pick a practice and let the visuals guide you.</p>
            </div>
        </div>
    </div>
    <div class="calm-hero__panel">
        <div class="calm-hero__panel-inner">
            <p class="eyebrow">Design-forward calm</p>
            <h3>Aligned layouts, gentle gradients, instant anchors.</h3>
            <p class="body">Everything sits on a consistent grid so nothing feels out of place. Slide into a flow, glance at the steps, and keep your focus on easing your breath.</p>
            <div class="calm-hero__chips">
                <span class="chip">Guided timing</span>
                <span class="chip">Soft motion</span>
                <span class="chip">Grounded palette</span>
            </div>
            <div class="calm-hero__panel-actions">
                <a class="btn tiny" href="{{ url_for('calming_tools') }}">Open calming tools</a>
                <a class="btn ghost tiny" href="https://youtu.be/3cXGt2d1RyQ?si=fW6VP-S2ooxIlJdK" target="_blank" rel="noopener">Watch calming video</a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}
<section class="calm-nav" aria-label="Calming practice navigation">
    <div>
        <p class="eyebrow">Choose your path</p>
        <h2>Open any tool in its own focused page.</h2>
        <p class="body">Each practice keeps the same visuals, timing controls, and guidance as before—now in dedicated routes for quick access.</p>
    </div>
    <div class="calm-nav__links">
        {% for tool in tool_cards %}
        <a class="pill ghost" href="{{ url_for('calming_tool', slug=tool.slug) }}">{{ tool.title }}</a>
        {% endfor %}
    </div>
</section>

<section id="tools" class="tools-gallery">
    {% for tool in tool_cards %}
    <article class="resource-card tool-card">
        <div class="card-header">
            <div class="dot"></div>
            <h3>{{ tool.title }}</h3>
        </div>
        <p class="body">{{ tool.description }}</p>
        {% set matching_tool = (tools | selectattr('slug', 'equalto', tool.count_slug if tool.count_slug is defined else tool.slug) | list).0 %}
        {% if matching_tool %}
        <p class="stat-line">
            <span class="stat-number" data-calming-count="{{ matching_tool.slug }}">{{ matching_tool.completed_count }}</span>
            <span class="stat-helper">times completed</span>
        </p>
        <ol class="breath">
            {% for step in matching_tool.steps %}
            <li>{{ step }}</li>
            {% endfor %}
        </ol>
        {% endif %}
        <div class="tool-card__actions">
            <a class="btn tiny" href="{{ url_for('calming_tool', slug=tool.slug) }}">Open tool</a>
            {% if matching_tool %}
            <button class="btn ghost tiny" type="button" data-calming-complete data-calming-slug="{{ matching_tool.slug }}">
                I tried this
            </button>
            {% endif %}
        </div>
    </article>
    {% endfor %}
</section>
{% endblock %}

{% block scripts %}
    <script src="/static/js/calming-common.js"></script>
{% endblock %}
